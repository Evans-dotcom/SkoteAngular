<div class="container mt-4">
<!-- Accounts Receivable Form Section -->
<div class="card shadow p-4 border-start border-success border-4">
<h4 class="mb-3 text-success">{{ isEdit ? 'Edit Accounts Receivable' : 'Add Accounts Receivable' }}</h4>

    <form (ngSubmit)="save()" class="row g-3">
        <div class="col-md-4">
            <label for="debtorName" class="form-label fw-bold">Debtor Name</label>
            <input type="text" class="form-control" id="debtorName" [(ngModel)]="selected.debtorName" name="debtorName" placeholder="Debtor Name" required>
        </div>

        <div class="col-md-4">
            <label for="amountDue" class="form-label fw-bold">Amount Due (Ksh)</label>
            <input type="number" class="form-control" id="amountDue" [(ngModel)]="selected.amountDue" name="amountDue" placeholder="Amount Due" required min="0">
        </div>

        <div class="col-md-4">
            <label for="reason" class="form-label fw-bold">Reason / Description</label>
            <input type="text" class="form-control" id="reason" [(ngModel)]="selected.reason" name="reason" placeholder="Reason">
        </div>

        <!-- Department dropdown -->
        <div class="col-md-6">
            <label for="department" class="form-label fw-bold">Department</label>
            <select class="form-select" id="department" [(ngModel)]="selected.department" name="department" (change)="onDepartmentChange()" required>
                <option value="">Select Department</option>
                <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
            </select>
        </div>

        <!-- Department Unit dropdown -->
        <div class="col-md-6">
            <label for="departmentUnit" class="form-label fw-bold">Department Unit</label>
            <select class="form-select" id="departmentUnit" [(ngModel)]="selected.departmentUnit" name="departmentUnit" [disabled]="units.length === 0" required>
                <option value="">Select Unit</option>
                <option *ngFor="let unit of units" [value]="unit">{{ unit }}</option>
            </select>
        </div>

        <div class="col-md-12">
            <label for="remarks" class="form-label fw-bold">Remarks / Additional Notes</label>
            <textarea class="form-control" id="remarks" [(ngModel)]="selected.remarks" name="remarks" placeholder="Remarks"></textarea>
        </div>

        <div class="col-md-12 text-end">
            <button type="submit" class="btn btn-success me-2">
                <i class="fa fa-save me-1"></i> {{ isEdit ? 'Update' : 'Save' }}
            </button>
            <button type="button" class="btn btn-secondary" (click)="resetForm()">
                <i class="fa fa-times me-1"></i> Clear
            </button>
        </div>
    </form>
</div>

<!-- Accounts Receivable Table Section -->
<div id="accounts-receivable-table" class="card mt-4 shadow p-3 border-start border-info border-4">
    <div class="d-flex justify-content-between align-items-center mb-3 no-print">
        <h5 class="text-info">Accounts Receivable Records ({{ receivables.length }} Records)</h5>
        <div>
            <button class="btn btn-outline-success btn-sm me-2" (click)="exportToExcel()">
                <i class="fa fa-file-excel"></i> Excel
            </button>
            <button class="btn btn-outline-danger btn-sm me-2" (click)="exportToPDF()">
                <i class="fa fa-file-pdf"></i> PDF
            </button>
            <button class="btn btn-outline-dark btn-sm" (click)="printTable()">
                <i class="fa fa-print"></i> Print
            </button>
        </div>
    </div>
    
    <div class="table-responsive">
        <table class="table table-bordered table-hover table-striped align-middle">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Debtor Name</th>
                    <th class="text-end">Amount Due (Ksh)</th>
                    <th>Reason</th>
                    <th>Department</th>
                    <th>Unit</th>
                    <th>Remarks</th>
                    <th class="no-print text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of receivables">
                    <td>{{ item.id }}</td>
                    <td>{{ item.debtorName }}</td>
                    <td class="text-end fw-bold">{{ item.amountDue | number:'1.0-2' }}</td>
                    <td>{{ item.reason }}</td>
                    <td>{{ item.department }}</td>
                    <td>{{ item.departmentUnit }}</td>
                    <td>{{ item.remarks }}</td>
                    <td class="no-print text-center">
                        <button class="btn btn-sm btn-warning me-1" (click)="edit(item)">
                            <i class="fa fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-sm btn-danger" (click)="delete(item.id)">
                            <i class="fa fa-trash"></i> Delete
                        </button>
                    </td>
                </tr>
                <tr *ngIf="receivables.length === 0">
                    <td colspan="8" class="text-center text-muted">No accounts receivable records found.</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>


</div>